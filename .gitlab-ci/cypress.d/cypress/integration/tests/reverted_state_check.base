Cypress.on('uncaught:exception', (err, runnable) => {
    // returning false here prevents Cypress from
    // failing the test
    // sign in caused problems without this... I don't care, it still fails if we messed something up.
    return false
})


describe('Check password policy set', () => {
    it('Visits PingOne Console', () => {
      cy.visit('https://console.pingone.com/?env=ENV_ID');
      //hide the new user guide, I don't wanna figure out clicking it.
      window.localStorage.setItem('ping-hideCompassGuide-c9513744-cf13-451f-b6e2-fa8e8e1e589','true')
      window.localStorage.setItem('ping-hideCompassGuide-NavGuide-d8bc4e1c-812e-46d7-a5ec-c162d21661d8','true')
      //login
      cy.get('#username').type('TEST_USERNAME');
      cy.get('#password').type('TEST_PASSWORD');
      cy.get('.button').click();
      //ensure we made it
      cy.url({ timeout: 100000 }).should('contain', '/overviewDashboard')
      //switch to WF environment
      cy.get('.astro-environment-selector__trigger').click();
      cy.get('.astro-environment-selector__environment').contains('WF').click();
      //navigate to identities > users.
      cy.get(':nth-child(3) > .nav-sidebar__section').click();
      //cy.get(':nth-child(2) > .nav-sidebar__node > .nav-sidebar__node-label').click();
      cy.get('.nav-sidebar__node').contains('Users').click();
      //No Bob's allowed here!
      cy.getIframeBody().find('[data-id="searchbar-input"]').type('Bob');
      cy.getIframeBody().find('[data-id="user-list"]').contains('No users found.');
      //Let's move to risk policies!
      cy.get(':nth-child(5) > .nav-sidebar__section').click();
      cy.get('.nav-sidebar__node').contains('Risk Policies').click();
      //Let's make sure we are default risky
      cy.getIframeBody().find('[data-id="expandable-row"]').contains('Default Risk');
      //finally, let's look at some password policies!
      cy.get('.nav-sidebar__node').contains('Password Policies').click();
      cy.getIframeBody().find('[data-id="policy-name-field-input"]').should('have.value','Basic');
      //get on out of here!
      cy.get('[data-id="account"]').click();
      cy.get('[data-id="signoff.link"]').click();
    })
})
